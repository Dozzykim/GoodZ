<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.springproject.goodz.product.mapper.ProductMapper">
	
	<!-- 관리자 목록 조회 -->
    <select id="list" resultType="com.springproject.goodz.product.dto.Product">
        SELECT *
		FROM product
    </select>

	<!-- 메인화면에 4개 띄우기 -->
	<select id="newArrivals" resultType="com.springproject.goodz.product.dto.Product">
		SELECT *
		FROM product
		ORDER BY created_at DESC
		LIMIT 4
	</select>

	<!-- 상품 등록 -->
	<insert id="insert" useGeneratedKeys="true" keyProperty="pNo">
		INSERT INTO product (category, b_name, product_name, price, stock_quantity, created_at, updated_at)
		VALUES (#{category}, #{bName}, #{productName}, #{price}, #{stockQuantity}, #{createdAt}, #{updatedAt})
	</insert>

	<!-- 상의 목록 -->
    <select id="top" resultType="com.springproject.goodz.product.dto.Product">
        SELECT *
		FROM product
		WHERE category = '상의'
    </select>

	<!-- 하의 목록 -->
    <select id="pants" resultType="com.springproject.goodz.product.dto.Product">
        SELECT *
		FROM product
		WHERE category = '하의'
    </select>

	<!-- 신발 목록 -->
    <select id="shoes" resultType="com.springproject.goodz.product.dto.Product">
        SELECT *
		FROM product
		WHERE category = '신발'
    </select>

	<!-- 악세사리 목록 -->
    <select id="accessory" resultType="com.springproject.goodz.product.dto.Product">
        SELECT *
		FROM product
		WHERE category = '악세사리'
    </select>

	<!-- 제품 조회 -->
	<select id="getProductBypNo" resultType="com.springproject.goodz.product.dto.Product">
		SELECT *
		FROM product
		WHERE p_no = #{pNo}
	</select>

	<!-- 상품 옵션 목록 조회 -->
	<select id="getProductOptionsByProductId" resultType="com.springproject.goodz.product.dto.ProductOption">
		SELECT *
		FROM product_option
		WHERE p_no = #{pNo}
	</select>

	<!-- 상품 이미지 목록 조회 -->
	<select id="getProductImagesByProductId" resultType="com.springproject.goodz.product.dto.ProductImage">
		SELECT *
		FROM product_image
		WHERE p_no = #{pNo}
	</select>

	<!-- 상품 옵션 추가 -->
	<insert id="insertProductOption" useGeneratedKeys="true" keyProperty="optionId">
		INSERT INTO product_option (p_no, size, option_price, stock_quantity, sku, status)
		VALUES (#{pNo}, #{size}, #{optionPrice}, #{stockQuantity}, #{sku}, #{status})
	</insert>

	<!-- 상품 이미지 추가 -->
	<insert id="insertProductImage" useGeneratedKeys="true" keyProperty="imgId">
		INSERT INTO product_image (p_no, image_url)
		VALUES (#{pNo}, #{imageUrl})
	</insert>

</mapper>
