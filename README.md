<div align=center>
<img alt="logo" src="https://github.com/Dozzykim/GoodZ/blob/main/img/logo-s.png">
</div>

# 👟GoodZ - Spring MVC
> 개발기간: 2024.05.16 ~ 2024.06.16

<br>

## 프로젝트 소개
- GOODZ는 유저들이 한정판 중고상품을 사고 팔고, 최신트렌드와 일상을 공유할 수 있는 플랫폼으로, <br>
  동일한 플랫폼인 크림을 벤치마킹하여 개발하였습니다.
- 자정을 기준으로, 일정 기준에 따라 인기도를 측정하여 상품의 가격이 변동됩니다.
- 유저는 마음에 드는 상품을 관심 저장하여 마이페이지에 저장할 수 있습니다.
- 전체 스타일 조회를 통해 다른 유저들의 게시글을 구경할 수 있습니다.
- 다양한 유저들을 팔로우하며, 마음에 드는 게시글에 좋아요/관심을 누르거나 댓글을 작성할 수 있습니다.

<br>

## 팀원 구성
<div align="center">

| **박은서** | **김도희** | **전나연** | **이정용** |
| :------: |  :------: | :------: | :------: |
| [<img src="https://avatars.githubusercontent.com/u/75926505?v=4" height=150 width=150> <br/> @parkes811-inu](https://github.com/parkes811-inu) | [<img src="https://avatars.githubusercontent.com/u/106290302?v=4" height=150 width=150> <br/> @Dozzykim](https://github.com/Dozzykim) | [<img src="https://avatars.githubusercontent.com/u/107173330?v=4" height=150 width=150> <br/> @Nayeoonn](https://github.com/Nayeoonn) | [<img src="https://avatars.githubusercontent.com/u/160222470?v=4" height=150 width=150> <br/> @somsomso](https://github.com/somsomso) |

</div>

<br>

## 1. 개발환경
- 사용언어: Java, HTML/CSS, JavaScript
- 프레임워크: SpringBoot, Spring Securtiy, Spring Batch, 
- 라이브러리: Lombok, Thymeleaf, MyBatis, Bootstrap, Chart.js, Oauth2, Spring DevTools
- 데이터베이스: MySQL
- 협업툴: Github, Trello, Notion

<br>


## 2. 프로젝트 구조
<div align="center">
  <img src="https://github.com/Dozzykim/GoodZ/blob/7e0a6600fbaecab84ab1ff9bd17ebecf24146e5d/img/project-structure-user.JPG" alt="프로젝트구조-사용자" width="550">
  <img src="https://github.com/Dozzykim/GoodZ/blob/7e0a6600fbaecab84ab1ff9bd17ebecf24146e5d/img/project-structure-admin.JPG" alt="프로젝트구조-관리자" width="550">
</div>

<br>

## 3. 담당 기능 - SNS 커뮤니티
- 👥팔로우 기능
- ❤️📌좋아요 & 관심 저장 기능
- 🔎실시간 검색 기능
- 📄게시글 CRUD
- 🗨️댓글 조회/등록/삭제
<br>
[기능 한눈에 보기](#기능-한눈에-보기)
<br>

## 4. 기능 자세히 보기
### 👥팔로우 기능
- 유저 간의 교류를 증진시키기 위해 비동기 요청을 활용하여 팔로우 기능을 구현했습니다.
로그인 유저의 팔로잉 상태에 따라 버튼이 동적으로 렌더링 되어 보여지며, 해당 버튼 클릭 시 버튼 상태에 따라 팔로우 혹은 언팔로우 요청이 동적으로 요청되는 방식으로 개발하였습니다.
1. **프로필화면 팔로워/팔로잉 정보 표시**
    - **팔로워/팔로잉 목록** : 비동기 요청을 통해 팔로워/팔로잉 목록을 서버에 각각 요청합니다.
    - **응답 처리**:  서버 사이드 렌더링된 follow.html을 응답받아 각각의 모달에 목록을 표시합니다.
    
2. **팔로우 버튼 동적 처리**
    - **로그인 상태에 따른 버튼 표시 로직**:
        - 로그인 유저인 경우 팔로잉 여부에 따라 ‘팔로우’/’팔로잉’ 텍스트 및 스타일을 달리 표시합니다.
        - 비로그인 유저인 경우, 항상 ‘팔로우’ 버튼을 표시합니다.
    - **구현 방법**: 프로필 화면 조회 시, 컨트롤러에서 세션을 통해 로그인 상태 확인하고, 로그인 유저의 팔로잉 목록 조회 후 모델에 담아 뷰로 전달합니다. 이후 Thymeleaf를 사용해 팔로잉 상태에 따라 버튼 상태를 동적으로 렌더링하여 표시합니다.
    
3. **팔로우/언팔로우 동작**
    - **요청 구분**: 버튼 클릭 시, 버튼 요소가 함수에 인자로 전달되며, 클래스명으로 팔로우 상태를 구분하여 비동기 요청을 보냅니다.
    - **응답 처리**: 서버로부터 처리 성공 여부 응답에 따라 팔로워/팔로잉 목록을 재 호출하여 UI와 목록을 실시간으로 업데이트하여 표시합니다.
<img src="https://github.com/Dozzykim/GoodZ/blob/3b837b4670db883639029f54312e2080f3cfef86/img/follow.gif" alt="팔로우기능" width="700">
<br><br>

### ❤️📌좋아요 &관심 기능
- 커뮤니티를 활성화시키고 마음에 드는 게시글/상품을 저장하여 따로 조회할 수 있는 편리함을 제공하기 위해 비동기 요청을 활용하여 좋아요 및 관심 기능을 구현했습니다.
1. **좋아요/관심 버튼 동적 처리**
    - **로그인 상태에 따른 버튼 표시 로직**:
        - 로그인 유저인 경우, 좋아요 및 관심 여부에 따라 svg 아이콘의 fill 속성을 다르게 설정하여 표시합니다.
        - 비로그인 유저인 경우, 해당 멤버변수의 값을 ‘none’으로 설정하여 표시합니다.
    - **구현 방법**: 화면 조회 시, 컨트롤러에서 세션을 통해 로그인 상태를 확인하고, 로그인 유저의 아이디와, 게시글 혹은 상품 번호를 가지고 DB에 조회하여 체크 여부를 확인합니다.
        - 게시글의 경우, 상세페이지뿐만 아니라 게시글 목록에서도 표시되어야 하므로 DTO에 좋아요/관심 체크 여부에 따라 svg 아이콘의 fill 속성값을 결정하는 String 타입의 멤버 변수를 두었습니다.
        - 상품의 경우, 상세 페이지에서만 관심 저장 기능이 사용되어, 체크 여부를 담은 boolean 타입 변수를 모델에 담아 뷰로 전달하였습니다.
        <br>
        이후 Thymeleaf를 사용해 상태에 따라 동적으로 렌더링하여 표시합니다.

2. **On & Off 동작**
    - **요청 구분**: 버튼 클릭 시, 버튼 요소와 함께 부모 테이블 정보와 게시글/상품 번호가 함수에 인자로 전달되며, svg 아이콘의 fill 속성으로 상태를 구분하여 비동기 요청을 보냅니다.
    - **응답 처리**: 서버로부터 처리성공 여부 응답에 따라 fill 속성을 변경하여 상태를 표시합니다.

<img src="https://github.com/Dozzykim/GoodZ/blob/878b394cbba235aa8faf7c73d110387544087b19/img/like%26wish.gif" alt="좋아요/관심기능" width="700">
<br><br>

### 🔎실시간 검색 기능(상품태그)
- 게시글에 상품을 태그함으로써 유저 간 정보교류를 활발히 만들며, 자연스럽게 상품 홍보 및 구매로 이어지도록 했습니다. 비동기 요청을 활용하여 실시간 검색 기능을 개발했습니다.
- **키워드 검색**
    - **키워드 입력**: 검색 키워드를 3글자 이상 입력 시,  비동기 요청을 통해 서버에 요청을 보내며 브랜드 혹은 상품명을 검색합니다.
    - **응답 처리**: 서버에서 검색된 상품 목록을 응답받아 검색 모달에 목록을 표시합니다.
<br><br>

### 📄 게시글 CRUD
<details>
<summary>1. 게시글 작성 </summary>

- **이미지 첨부**
  - 이미지를 첨부하면 하단에 첨부한 이미지가 미리보기로 보여집니다.
  - 대표 이미지 선택 기능으로 게시글 노출 시 보여질 이미지를 선택하도록 구현하였습니다.
    
- **상품태그**
  - **검색**: 3글자 이상 키워드를 입력하여  브랜드/상품명 검색합니다. 서버에 ajax 비동기 요청을 통해 서버사이드렌더링 방식으로 반환결과를 출력합니다.
  - **추가**: 검색 결과 클릭 시 태그 박스에 추가합니다. (JavaScript DOM 조작)
  - **제거**: 추가된 태그 클릭 시 제거합니다. (JavaScript DOM 조작)
    
  - ajax 비동기 요청을 통해 게시글 작성 처리를 진행하고 처리 성공시, 프로필로 리다이렉트 합니다.
   <br><br>
</details>

<details>
<summary>2. 게시글 수정</summary>
  
  - 기존 내용 및 상품태그 정보를 조회하여 세팅합니다.
    
  - 작성 과정과 동일하나 이미지는 수정이 불가합니다.
    
  - ajax 비동기 요청을 통해 서버에 게시글 수정 처리를 진행하고 처리 성공 시, 프로필로 리다이렉트 합니다.
    
 <br><br>
</details>

<details>
<summary>3. 게시글 조회</summary>
  
  - 게시글 번호 파라미터로 게시글 및 종속된 댓글을 조회합니다.
  
  - 로그인 상태에 따른 기능 제어
    - 본인 게시글
      - 우측 버튼: 수정/삭제 버튼 활성화
    - 타인 게시글 또는 비로그인
      - 우측 버튼: 팔로우 버튼 활성화
<br><br>
</details>

<details>
<summary>3. 게시글 삭제</summary>
  
  - **요청** : 삭제 버튼 클릭 시  게시글 번호가 인자로 넘어가, 서버에 비동기로 게시글 삭제를 요청합니다. 
    
  - **응답 처리**: 처리 성공 시, 프로필로 리다이렉트합니다.
<br><br>
</details>

<br>

### 🗨️댓글 조회/등록/삭제
- 게시글 상세 페이지에서 댓글기능을 사용 가능합니다.
  
<details>
<summary>1. 댓글 조회</summary>
  
  - **요청**: 게시글 번호 파라미터로 종속된 댓글을 비동기로 요청합니다.
    
  - **응답 처리**: 세션에 저장된 로그인 유저의 정보도 함께 반환하여 Thymeleaf를 통해 댓글 작성자의 아이디와 비교 후 댓글 소유 여부에 따라 삭제 버튼 활성화하고, DB에서 조회된 댓글리스트를 서버사이드렌더링을 통해 화면에 출력 합니다.

<br><br>
</details>

<details>
<summary>2. 댓글 작성</summary>

  1. **비로그인 유저 이용 제한**
      - 댓글 입력 필드 클릭 시 로그인 상태를 확인합니다.
          - HTML 데이터 속성을 활용하여 서버에서 로그인 상태 전달합니다.
      - 이벤트 리스너를 통해 클릭 감지 시, 로그인 페이지 이동 옵션 제공 합니다.
     
  2. **댓글 작성처리**
      - **요청**: 게시글 번호, 작성자 Id, 댓글 내용을 담은 데이터를 서버에 비동기 방식으로 요청하였습니다.
      - **응답 처리**: 처리 성공 시, 댓글 목록과 갯수를 갱신하며 입력창을 비워둡니다.
<br><br>
</details>

<details>
<summary>3. 댓글 삭제</summary>
  
  - 작성자만 삭제가 가능하며, 아이디 일치 여부에 따라 버튼을 활성화하였습니다.
    
  - **요청**: 삭제 버튼 클릭 시 연결된 함수에 댓글번호가 인자로 전달되어 비동기로 삭제를 요청합니다.
    
  - **응답 처리**: 처리 성공 시, 댓글목록을 재 요청하여 실시간으로 내용을 업데이트하여 보여줍니다.
<br><br>
</details>

<br>

## 문제사항 및 해결방법

### **‼️게시글 작성/수정 처리 완료 시 리다이렉트 처리 문제**

- **화면 이동 순서:** 게시글 작성/상세 페이지 ➡ 컨트롤러에 데이터 처리 ➡ 프로필화면으로 이동
- **문제점**: MVC 패턴에서 컨트롤러 메서드는 결과 반환 시 나타낼 데이터를 모델에 담고, 뷰로 보여줄 HTML 경로를 반환합니다. 화면 이동 순서에 따라 처리 후 프로필 화면으로 이동되어야 했습니다. 그러나 유저의 프로필로 진입하는 URL은 경로에 유저의 닉네임이 파라미터로 전달되어 GET 방식을 통해 유저의 정보를 조회하여 처리합니다. 따라서 단순한 리다이렉트 방식의 리턴값으로는 유저의 정보가 세팅되지 않아 화면전환이 되지 않았습니다.
    - 유저 프로필 조회 요청경로: “/styles/user/@{nickname}”
    - 유저 프로필를 출력할 뷰: “/post/user/profile”
    - 만약, 조회 요청경로와 뷰의 경로가 일치했다면, 모델에 담아 리다이렉트를 하는 방식으로 해결할 수 있었지만, 노출되는 프로필 URL을 변경없이 해결하고자 하였습니다.
- **해결방법**: 비동기 요청으로 진행하여 처리 여부를 String 타입으로 반환해 준 다음, 응답에 따라 자바스크립트를 통해 자연스럽게 유저의 프로필로 리다이렉트 처리하였습니다.

<br><br>

## 기능 한눈에 보기
### 전체 게시글
<img src="https://github.com/Dozzykim/GoodZ/blob/3b837b4670db883639029f54312e2080f3cfef86/img/allPosts.gif" alt="전체게시글" width="700">
<br><br>

### 유저 프로필
<img src="https://github.com/Dozzykim/GoodZ/blob/fbb809a14c58df99b4ae2f23080289d743100d68/img/profile.gif" alt="프로필" width="700">
<br><br>

### 게시글 상세 및 댓글
<img src="https://github.com/Dozzykim/GoodZ/blob/d1d8781b35f577fa115633412208c276d1575811/img/comment.gif" alt="게시글상세" width="700">
<br><br>

### 게시글 작성(/w 상품태그)
<img src="https://github.com/Dozzykim/GoodZ/blob/d1d8781b35f577fa115633412208c276d1575811/img/insertPost.gif" alt="게시글작성" width="700">
<br><br>

### 게시글 삭제
<img src="https://github.com/Dozzykim/GoodZ/blob/d67cdc76282b8853abc802dda04f66db90235c4b/img/deletePost.gif" alt="게시글삭제" width="700">
<br><br>
